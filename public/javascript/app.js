// Generated by CozyScript 0.1.1
(function() {
  var app;

  app = angular.module('moedict-web', ['ngResource', '$strap.directives']);

  app.controller('MoeDictCtrl', function($scope, $resource) {
    var MoeDict, MoeTitleDict, last_title_q;
    MoeDict = $resource('/q/:query$');
    MoeTitleDict = $resource('/q/title/:query');
    $scope.dict_items = [];
    $scope.dict_content = {};
    last_title_q = ' ';
    return $scope.change = function() {
      var dict_content, dict_items;
      if ($scope.dict_q.length >= 1 && $scope.dict_q.indexOf(last_title_q) !== 0) {
        last_title_q = $scope.dict_q.substring(0, 1);
        dict_items = MoeTitleDict.query({
          query: last_title_q
        }, function() {
          var item, _i, _len, _results;
          $scope.dict_items = [];
          _results = [];
          for (_i = 0, _len = dict_items.length; _i < _len; _i++) {
            item = dict_items[_i];
            _results.push($scope.dict_items.push(item.title));
          }
          return _results;
        });
      }
      return dict_content = MoeDict.query({
        query: $scope.dict_q
      }, function() {
        if ((dict_content != null) && (dict_content[0] != null) && (dict_content[0].title != null)) {
          dict_content[0].bopomofo = dict_content[0].bopomofo.replace(/^(\s*)/, '');
          return $scope.dict_content = dict_content[0];
        }
      });
    };
  });

}).call(this);
